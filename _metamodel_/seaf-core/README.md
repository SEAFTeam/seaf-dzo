# SEAF
Sber Enterprise Architecture Framework (SEAF) - открытый и развиваемый сообществом экспертов-практиков 
архитектурный фреймворк в своей основе использующий подход "Архитектура как код".

## Манифест

1. Вклад сообщества в развитие фреймворка является наивысшей ценностью для нас.

2. Миссия сообщества SEAF - создание технологии цифровой моделей предприятия. Мы считаем, что достичь ее можно
   описывая архитектуру специальным кодом, поддающимся автоматизированному анализу.

3. Мы не противопоставляем SEAF другим фреймворкам. Наш принцип – использовать лучшее из них.

4. Мы считаем, что SEAF должен удовлетворять потребностям предприятий любого масштаба. Обеспечивать их ценностью
   на всех этапах развития.

5. Мы признаем, что архитектурная функция распределена между всеми участниками трансформаций, поэтому он основан
   на простоте и низком пороге входа для любого участника изменений. Наш фреймворк не требует выделенной роли архитектора.

6. Мы поставляем метамодель и методологию, которые должны адаптироваться и развиваться под потребности конкретного
   предприятия, выявленные домены и слои архитектуры.

7. Эти принципы мы создали на основе нашего успешного опыта управления архитектурой в Группе Сбер. Мы верим, что
   они наделяют SEAF уникальными способностями:
    * Cтимулировать инновации архитектурной функции;
    * Аккумулировать и распространять лучшие практики;
    * Создавать условия для коллаборации в сложных системах управления.

## Архитектура фреймворка
```

|--------------------------- 1. ФИЛОСОФИЯ ----------------------------|
|                                                                     |
|      [2. Подходы и принципы] [3. Ценности] [4. Протомодель]         |
|                                                                     |
| |-------- 5. ПОСТАВКА --------|  |-------- 11.СООБЩЕСТВО ---------| |
| | [6. Референсный инструмент] |  |  [12. Репозиторий фреймворка]  | |
| |      [7. Методология]       |  |  [13. Проф. гуруппы и каналы]  | |
| |    [8. Практики/кейсы]      |  | [14. Статьи, воркшопы, митапы] | |
| |  [9. Базовая метамодель]    |  |--------------------------------| |
| |     [10. Документация]      |                                     |
| |-----------------------------|                                     |
|                                                                     |
|---------------------------------------------------------------------|

```

* (1, 2, 3, 4) Философия фреймворка выражается в [манифесте](#манифест);
* (5) Под поставкой понимается выпуск очередного релиза фреймворка в форме repo;
* (6) В качестве референсного инструмента предлагается [DocHub](https://github.com/RabotaRu/DocHub);
* (7) Методология включается в виде документов в поставку;
* (8) Поставка содержит [пример](/entities/components/tree) описания архитектуры,
  а также предлагается репозиторий [примеров](https://github.com/rpiontik/DocHubExamples)
  применения подхода;
* (9) Входит в поставку;
* (10) Входит в поставку;
* (11) Сообщество обеспечивает развитие фреймворка и генерирует поставку;
* (12) [Репозиторий фреймворка])(https://github.com/RabotaRu/DocHub);
* (13) Группа сообщества развивающего подход управления архитектуры кодом [DocHubTeam](https://t.me/archascode);
* (14) [Статьи о развитии подхода](https://habr.com/ru/users/rpiontik/) и видео
  c [воркшопами и митапами](https://www.youtube.com/@user-eq5pj3zk6w).

## Метамодель

SEAF предусматривает мутабельность метамодели. Ее постоянное совершенствование
сообществом.

### Базовый подход к формированию слоев и вертикалей

Для структурирования метамодели выбран подход разделения ее на слои и вертикали.

Слои выделяют функциональные области, в то время как вертикали пронизывают их 
и связывают.

Выделяются слои:
1. Бизнес-архитектура;
2. Прикладная архитектура;
3. Техническая архитектура.

И вертикали:
1. Информационная архитектура;
2. Управление требованиями.

Важным принципом метамодели данной поставки является - адаптивность. Она должна
легко подстраиваться под нужды использования. Предполагает частичное применение,
возможность расширения и модификации.

Таким образом, решение о фактическом объеме использования метамодели 
предоставляется пользователю. 

### Паттерн слоя

В ходе проектирования метамодели мы выявили устойчивы паттерн слоя:

![Базовый подход к формированию слоев](docs/images/mm_base.png)

### Общая метамодель

![Метамодель](docs/images/mm.png)

## Архитектурный репозиторий

В основе SEAF лежит подход "Архитектура как код". Любое архитектурное описание
выражается архитектурным кодом - **архкодом**. Дла управления им актуальны многие
практики управления кодом приложений, инфраструктуры и т.п.

Но есть и отличия ввиду специфики само предметной области - управление архитектурой.

Для удобства сообщества фреймворк предлагает стандартизацию некоторых аспектов
управления архкодом. 

### Соглашение по структуре архитектурных репозиториев
```
|- _metamodel_                 - Подключенные пакеты метамоделей
|  |- [название пакета]        - Пакет метамодели
|  |  |- entities              - Сущности метамодели
|  |  |  |- [...]              - Структура каталогов сущностей
|  |  |  |  |- template        - Шаблоны для презентаций
|  |  |- functions             - Запросы написанные на JSONata
|  |  |- docs                  - Документация по репозиторию
|  |  |- architecture          - Архитектурные объекты поставляемые с пакетом
|  |  |  |- app                - Прикладная архитектура
|  |  |  |- ba                 - Бизнес-архитектура
|  |  |  |- ta                 - Техническая архитектура
|  |  |  |- ia                 - Информационная архитектура
|  |  |- dochub.yaml           - Корневой манифест пакета
|  |  |- README.md             - Описание пакета
|  |  |- LICENSE               - Лицензия под которой распространяется пакет
|- architecture                - Архитектурные объекты
|  |- app                      - Архитектурные объекты
|  |- ba                       - Бизнес-архитектура
|  |- ta                       - Техническая архитектура
|  |- ia                       - Информационная архитектура
|- facades                     - Подключаемые внешние архитектурные объекты
|- README.md                   - Ключевая информация по репозиторию
|- dochub.yaml                 - Корневой манифест репозитория
```

Предлагаемая структура является рекомендуемой и может расширяться при необходимости.

### Соглашение по идентификации архитектурных объектов

1. Идентификаторы должны соответствовать принципу DDD (структурированные идентифкаторы);
2. Используются только строчные символы;
3. Для разделения домена используется символ - "."
4. Для разделения слов - "_";
5. Системные идентификаторы должны начинаться с "$";
6. В идентификаторах могу быть использованы только символы - a..z 0..9 "_" "." "$";
7. Идентификаторы должны отражать смысл и быть существительным.

**RegEx для идентификаторов:** ^\[a-z0-9_\$]\[a-z0-9_\$]\*(\.\[a-z0-9_\$]\[a-z0-9_\$]\*)*$

Предлагается следующая структура идентификаторов:
```
[зона www].[домен].**
```

Примеры:
```
info.dochub.frontend
ru.nalog.site_fns
ru.yandex.app.search
```

## Процессы управления

Для управления кодовой базой архитектуры предлагается применять успешные практики развития
кодовой базы приложений и инфраструктуры с учетом специфики предметной области управления
архитектурой.

Использованием систем управления версиями лежит в основе предлагаемых процессов. 

### Сегментация кодовой базы

Рекомендуется сегментировать кодовую базу в соответствии с логическими пространствами
доменов управления, придерживаясь принципов федеративного управления архитектурой.

Например, если вы практикуете микросервисную архитектуру, будет уместно выделить следующие сегменты
и разместить их в отдельных репозиториях:

1. **Metamodel** - стандартизированная метамодель, которую будут использовать и развивать все команды;
2. **General** - репозиторий обобщающий информацию о всех микросервисах и представляющий их как систему
   для нужд всех команд;
3. **Team1** - репозиторий команды, в котором она развивает архитектуру микросервисов.

Такое разделение позволит минимизировать информационный шум для участников архитектурных преобразований,
а также настроить ролевую модель.

Для удобства разработчиков, архкод развиваемый командой можно расположить непосредственно в 
репозиториях микросервисов.

```plantuml
@startuml
title Управление сегментами архкода
actor "Team 1" as team_a
actor "Team 2" as team_b
participant "[[https://dochub.info/ DocHub]]" as dochub
database "Repo\nTeam 1" as repo_a
database "Repo\nTeam 2" as repo_b
database "Repo\nMetamodel" as metamodel
database "Repo\nGeneral" as repo_main

group Обзор архитектуры
    dochub <- repo_main: General
    dochub <- metamodel: Метамодель
    dochub <- repo_b: Архкод
    dochub <- repo_a: Архкод
    team_a <- dochub: Артефакты
    team_b <- dochub: Артефакты
end

group Фокус на своем сегменте
    dochub <- metamodel: Метамодель
    dochub <- repo_a: Архкод
    team_a <- dochub: Артефакты
    dochub <- metamodel: Метамодель
    dochub <- repo_b: Архкод
    team_b <- dochub: Артефакты
end

@enduml

```

Связать репозитории и представить их в едином интерфейсе позволит референсный инструмент -
[DocHub](https://dochub.info/)

### Развития архкода

В качестве целей развития архкода рассматривается :
1. Проектирование и планирование архитектурных изменений (to-be);
2. Фиксация и документирование состоявшихся изменений (as-is).

Для реализации этих целей предлагается следующий процесс: 

```mermaid
gitGraph
    commit id: "First commit"
    branch "ADR#"
    commit
    branch increment
    commit tag: "req-1"
    commit tag: "req-2"
    checkout "ADR#"
    merge increment

    checkout "main"
    commit
    checkout "ADR#"
    merge "main"

    checkout "ADR#"
    commit tag: "TO-DO"
    branch "change#"
    checkout "change#"
    commit tag: "done"

    checkout "main"
    commit
    checkout "change#"
    merge main


    checkout main
    merge "change#"
    commit tag: "ADR#"
```

Здесь ветка **"main"** отражает "как есть", т.е. представление о том, какая архитектура
имеется на текущий момент.

При необходимости архитектурных преобразований, создается ветка **ADR (Architecture Decision Record)**.
Первоначально в ветке отражается суть преобразований. Т.е. регистрируется сам ADR.

ADR подразумевает одно преобразование или их комплекс. Каждое целевое преобразование
оформляется как архитектурный инкремент - **Increment**.

Increment отщипывается от ветки ADR и развивается в соответствии с требованиями по
преобразованию. При завершении имплементации требования, комит тегируется 
исполненным требованием. Это делается для удобства контроля полноты реализации
ADR, а также позволяет локализовывать сегмент архкода отвечающий за них.

По завершению наполнения инкремента, он вливается в ветку ADR.

Когда ветка ADR скомплектована, она тегируется к реализации **"to-do"**.

Готовые к реализации ADR берутся в работу. Для этого от ADR отщипывается ветка
**"change"**. В ходе реализации ветки, допускается детализация архкода без 
противоречия сути ADR.

После имплементации преобразований, ветка change вливается в main. 
Таким образом происходит актуализация архитектуры "как есть". Актуализация
тегируется исполненным ADR с целью контролироля реализация ADR.

Если ADR оказывается слишком сложным (большим), необходимо его декомпозировать.
Для этого использовать подход структурирования идентификаторов. Например, ADR по 
созданию новой системы с номером ARD12 разделить на: ADR12.1; ADR12.2 и т.д.

Такая идентификация позволит не утерять смысл при чтении тегов и проще 
контролировать целостность преобразований.

__При развитии архкода, на постоянной основе, должна происходить синхронизация с веткой
main для актуализации знаний о реальной архитектуре с целью контроля реализуемости 
проектируемых изменений.__

### Федеративное управление архитектурой

SEAF рассматривает федеративное управление архитектурой как инструмент
эффективного управления в сложных, неоднородных системах и системах с динамической
сложностью.

Под динамической сложностью понимается усложнение системы в ответ на 
достижение цели полного управления ей. 

Как пример можно рассмотреть команду разработчиков, где были грамотно выстроены
процессы и она показала высокие результаты. У руководства компании возникает 
желание тиражировать этот опыт на другие команды. 

Таким образом, изначально построенная и достигшая высокой эффективности система
управления усложняется, т.к. ее контур значительно расширяется до масштаба компании,
что приводит к значительной потере в управляемости на какое-то время.

Подобный пример можно привести в плоскости технологий. DevOps инженер может 
отлично настроить производственный контур для конкретного продукта, что обеспечит
его своевременный выпуск и надежность. Таким образом он создаст технологические 
предпосылки для его успеха на рынке.

В ответ на успех последует рост продукта, команды и технологическое разнообразие.

Очевидно, выраженной динамической сложностью обладают развивающиеся системы.



![Федеративное управление архитектурой](docs/images/federation.png)

## Развитие кодовой базы фреймворка

```mermaid
gitGraph
    commit id: "Initial"
    branch master
    commit id: "First commit"
    branch v1.0.0
    commit
    branch feature
    commit
    commit
    checkout v1.0.0
    merge feature
    checkout master
    merge v1.0.0
    commit id: "Release" tag: "v1.0.0"
    branch hotfix1
    checkout hotfix1
    commit id: "Fix"
    checkout master
    merge hotfix1
    commit id: "Hotfix" tag: "v1.0.1"
```

## Лицензия

Распространяется под лицензией Apache License 2.0 Open source license.



