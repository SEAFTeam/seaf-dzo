# ADR (Architecture Decision Record)
# Основано на https://github.com/joelparkerhenderson/architecture-decision-record
entities:
  seaf.adr:
    title: Architecture Decision Record
    schema:
      $defs:
        seaf.adr.issue:
          type: string
          title: Описание проблемы
          description: >
            Опишите проблему архитектурного проектирования, которую вы решаете,
            не оставляя вопросов о том, почему вы решаете эту проблему сейчас.
            Следуя минималистскому подходу, рассматривайте и документируйте только
            те проблемы, которые требуют решения на различных этапах жизненного цикла.
        seaf.adr.decision:
          type: string
          title: Решение
          description: >
            Четко определите архитектурное решение.
        seaf.adr.affects.area:
          title: Область эффекта
          type: string
          enum:
            - people      # Люди
            - money       # Деньги
            - resources   # Ресурсы
            - time        # Время
            - business    # Бизнес
            - technology  # Технологии
            - other       # Прочее
        seaf.adr.affects.vector:
          title: Область эффекта
          type: string
          enum:
            - negative    # Негативное влияние
            - positive    # Позитивное влияние
            - unknown     # Неизвестно
        seaf.adr.context.item:
          title: Характеристика контекста
          type: object
          properties:
            area:
              $ref: "#/$defs/seaf.adr.affects.area"
            vector:
              $ref: "#/$defs/seaf.adr.affects.vector"
            content:
              title: Описание характеристики
              type: string
              description: >
                Четко опишите характеристику контекста
          required:
            - area
            - vector
            - content
        seaf.adr.context:
          title: Контекст принятия решения
          description: >
            Укажите все важные сведения влияющие на принятие решения
          type: array
          minItems: 1
          items:
            $ref: "#/$defs/seaf.adr.context.item"
        seaf.adr.consequences.item:
          title: Характеристика последствий
          type: object
          properties:
            area:
              $ref: "#/$defs/seaf.adr.affects.area"
            vector:
              $ref: "#/$defs/seaf.adr.affects.vector"
            content:
              title: Описание характеристики
              type: string
              description: >
                Четко опишите последствия принятого решения
          required:
            - area
            - vector
            - content
        seaf.adr.consequences:
          title: Последствия
          description: >
            Укажите все важные последствия принятого архитектурного решения
          type: array
          minItems: 1
          items:
            $ref: "#/$defs/seaf.adr.consequences.item"
        seaf.adr.requirements.item:
          title: Требование
          description: >
            Укажите требование, которое удовлетворяет решение
          $ref: "#/$rels/seaf.requirements.requirement"
        seaf.adr.requirements:
          title: Требования
          description: >
            Перечислите требование, которые должно удовлетворить архитектурное решение
          type: array
          minItems: 1
          items:
            $ref: "#/$defs/seaf.adr.requirements.item"
        seaf.adr.deciders.item:
          title: Принимающий решение
          type: string
        seaf.adr.deciders:
          title: Кто принял решение
          description: >
            Укажите всех, кто принимал архитектурное решение.
          type: array
          minItems: 1
          items:
            $ref: "#/$defs/seaf.adr.deciders.item"
        seaf.adr.dependencies.item:
          title: Зависимость от другого решения
          $ref: "#/$rels/seaf.adr.adr"
        seaf.adr.dependencies:
          title: Зависимости от других решений
          description: >
            Укажите от каких решений зависит данное
          type: array
          minItems: 1
          items:
            $ref: "#/$defs/seaf.adr.dependencies.item"
        seaf.adr:
          type: object
          properties:
            title:
              type: string
              title: Название
            moment:
              type: string
              title: Дата создания
              pattern: ^[0-9]{4}\-[0-9]{2}\-[0-9]{2}$
            issue:
              $ref: "#/$defs/seaf.adr.issue"
            deciders:
              $ref: "#/$defs/seaf.adr.deciders"
            decision:
              $ref: "#/$defs/seaf.adr.decision"
            context:
              $ref: "#/$defs/seaf.adr.context"
            consequences:
              $ref: "#/$defs/seaf.adr.consequences"
            requirements:
              $ref: "#/$defs/seaf.adr.requirements"
            dependencies:
              $ref: "#/$defs/seaf.adr.dependencies"
          required:
            - title
            - moment
            - issue
            - decision
            - status
            - context
            - context
            - consequences
      type: object
      patternProperties:
        "^[a-z0-9_\\$][a-z0-9_\\$]*(\\.[a-z0-9_\\$][a-z0-9_\\$]*)*$":
          $ref: "#/$defs/seaf.adr"
    objects:
      adr:
        route: "/"
        title: ADR
    menu: >
      (       
          $append(
              [{
                  "location": "Анализ/ADR",
                  "link": "/entities/seaf.adr/list"
              }],
              $seaf_menu_location_by_id(
                    $."seaf.adr",
                    "",
                    "Анализ/ADR/",
                    function($location, $item, $itemId, $collection){{
                        "location": $location,
                        "link": "/entities/seaf.adr/blank?seaf-adr-id=" & $itemId
                    }}
            )
        );
      )